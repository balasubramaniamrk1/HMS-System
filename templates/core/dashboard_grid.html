{% extends 'base.html' %}
{% load static %}
{% load auth_extras %}

{% block title %}Dashboard{% endblock %}

{% block extra_css %}
<style>
    /* Dashboard Specific Styles */
    .page-header {
        margin-bottom: 30px;
        color: #7f8c8d;
        font-size: 1.5rem;
        font-weight: 400;
        margin-top: 10px;
    }

    /* Dashboard Icons Grid */
    .dashboard-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
        gap: 30px;
    }

    .dash-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
        text-decoration: none;
        color: #34495e;
        transition: transform 0.2s;
        background: white;
        padding: 20px 10px;
        border-radius: 12px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
    }

    .dash-item:hover {
        transform: translateY(-5px);
        text-decoration: none;
        color: var(--primary-color);
        box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
    }

    .icon-circle {
        width: 70px;
        height: 70px;
        background: #f8f9fa;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 15px;
        font-size: 1.8rem;
        color: var(--primary-color);
    }

    .dash-label {
        font-size: 0.85rem;
        font-weight: 600;
        text-transform: uppercase;
        line-height: 1.3;
    }

    /* Icon Colors */
    .icon-red {
        color: #e74c3c;
    }

    .icon-blue {
        color: #3498db;
    }

    .icon-green {
        color: #2ecc71;
    }

    .icon-orange {
        color: #e67e22;
    }

    .icon-teal {
        color: #1abc9c;
    }
</style>
{% endblock %}

{% block content %}
<h2 class="page-header">Dashboard</h2>

<div class="dashboard-grid">

    {% if user|has_group:"Doctors" or user.is_superuser or user|has_group:"Hospital Admins" %}
    <a href="{% url 'doctor_console' %}" class="dash-item">
        <div class="icon-circle"><i class="fas fa-calendar-alt icon-red"></i></div>
        <span class="dash-label">Doctor Console</span>
    </a>
    {% endif %}

    <a href="{% url 'book_appointment' %}" class="dash-item">
        <div class="icon-circle"><i class="fas fa-calendar-check icon-red"></i></div>
        <span class="dash-label">Appointment</span>
    </a>

    {% if user|has_group:"Doctors" or user.is_superuser or user|has_group:"Hospital Admins" %}
    <!-- Generic staff too -->
    <a href="#" class="dash-item">
        <div class="icon-circle"><i class="fas fa-clipboard-list icon-orange"></i></div>
        <span class="dash-label">Patient Registration</span>
    </a>
    {% endif %}

    <a href="#" class="dash-item">
        <div class="icon-circle"><i class="fas fa-procedures icon-blue"></i></div>
        <span class="dash-label">Outpatient Management</span>
    </a>

    <a href="#" class="dash-item">
        <div class="icon-circle"><i class="fas fa-heartbeat icon-red"></i></div>
        <span class="dash-label">Health Checkup</span>
    </a>

    <a href="#" class="dash-item">
        <div class="icon-circle"><i class="fas fa-flask icon-blue"></i></div>
        <span class="dash-label">Laboratory</span>
    </a>

    <a href="#" class="dash-item">
        <div class="icon-circle"><i class="fas fa-x-ray icon-teal"></i></div>
        <span class="dash-label">Radiology</span>
    </a>

    <a href="#" class="dash-item">
        <div class="icon-circle"><i class="fas fa-bed icon-green"></i></div>
        <span class="dash-label">Inpatient Management</span>
    </a>

    {% if user|has_any_group:"Pharmacist,Inventory Managers" or user.is_superuser or user|has_group:"Hospital Admins" %}
    <a href="{% url 'pharmacy:dashboard' %}" class="dash-item">
        <div class="icon-circle"><i class="fas fa-pills icon-blue"></i></div>
        <span class="dash-label">Pharmacy</span>
    </a>
    {% endif %}

    <a href="#" class="dash-item">
        <div class="icon-circle"><i class="fas fa-user-nurse icon-teal"></i></div>
        <span class="dash-label">Nurse Station</span>
    </a>

    <a href="#" class="dash-item">
        <div class="icon-circle"><i class="fas fa-cut icon-red"></i></div>
        <span class="dash-label">Operation Theatre</span>
    </a>

    <a href="#" class="dash-item">
        <div class="icon-circle"><i class="fas fa-tint icon-red"></i></div>
        <span class="dash-label">Blood Bank</span>
    </a>

    {% if user|has_group:"Hospital Admins" or user.is_superuser %}
    <a href="{% url 'staff_mgmt:admin_dashboard' %}" class="dash-item">
        <div class="icon-circle"><i class="fas fa-chart-line icon-orange"></i></div>
        <span class="dash-label">MIS Reports</span>
    </a>

    <a href="{% url 'admin_access' %}" class="dash-item">
        <div class="icon-circle"><i class="fas fa-cogs icon-blue"></i></div>
        <span class="dash-label">System Control</span>
    </a>
    {% endif %}

    {% if user|has_group:"Billing" or user.is_superuser or user|has_group:"Hospital Admins" %}
    <a href="{% url 'billing:dashboard' %}" class="dash-item">
        <div class="icon-circle"><i class="fas fa-file-invoice-dollar icon-green"></i></div>
        <span class="dash-label">Billing</span>
    </a>
    {% endif %}

    {% if user|has_group:"Inventory Managers" or user.is_superuser or user|has_group:"Hospital Admins" %}
    <a href="{% url 'inventory_dashboard' %}" class="dash-item">
        <div class="icon-circle"><i class="fas fa-boxes icon-orange"></i></div>
        <span class="dash-label">Inventory</span>
    </a>
    <a href="{% url 'vendor_list' %}" class="dash-item">
        <div class="icon-circle"><i class="fas fa-truck icon-orange"></i></div>
        <span class="dash-label">Vendor Mgmt</span>
    </a>
    <a href="{% url 'amc_list' %}" class="dash-item">
        <div class="icon-circle"><i class="fas fa-file-signature icon-teal"></i></div>
        <span class="dash-label">AMC Contracts</span>
    </a>
    {% endif %}

    {% if user|has_any_group:"Pharmacist,Inventory Managers" or user.is_superuser or user|has_group:"Hospital Admins" %}
    <a href="{% url 'pharmacy:pos' %}" class="dash-item">
        <div class="icon-circle"><i class="fas fa-cash-register icon-blue"></i></div>
        <span class="dash-label">POS / Dispense</span>
    </a>
    <a href="{% url 'pharmacy:purchase_order_list' %}" class="dash-item">
        <div class="icon-circle"><i class="fas fa-file-contract icon-orange"></i></div>
        <span class="dash-label">Purchase Orders</span>
    </a>
    <a href="{% url 'pharmacy:stock_list' %}" class="dash-item">
        <div class="icon-circle"><i class="fas fa-cubes icon-green"></i></div>
        <span class="dash-label">Stock</span>
    </a>
    {% endif %}

    {% if user|has_group:"Receptionist" or user|has_group:"Front Desk" or user.is_superuser or user|has_group:"Hospital Admins" %}
    <a href="{% url 'staff_dashboard' %}" class="dash-item">
        <div class="icon-circle"><i class="fas fa-concierge-bell icon-teal"></i></div>
        <span class="dash-label">Front Desk</span>
    </a>
    {% endif %}

    <a href="{% url 'admissions:dashboard' %}" class="dash-item">
        <div class="icon-circle"><i class="fas fa-procedures icon-blue"></i></div>
        <span class="dash-label">Admissions (IPD)</span>
    </a>

    {% if user.doctor_profile or user|has_group:"Doctors" or user.is_superuser or user|has_group:"Hospital Admins" %}
    <a href="{% url 'reports_dashboard' %}" class="dash-item">
        <div class="icon-circle"><i class="fas fa-file-medical-alt icon-red"></i></div>
        <span class="dash-label">Consultation Reports</span>
    </a>
    {% endif %}

    <a href="#" class="dash-item">
        <div class="icon-circle"><i class="fas fa-users icon-blue"></i></div>
        <span class="dash-label">HR Management</span>
    </a>

</div>
{% endblock %}